<?xml version="1.0" encoding="utf-8"?>
<odoo>
<data>
<template id="report_machine_summary_template">
     <tbody>
          <tr style="page-break-inside:avoid!important;page-break-after:auto">
                <td t-att-rowspan="partcount" style="width:8%"><span t-field="r.name" /> </td>
                <td t-att-rowspan="partcount" style="width:8%"><span t-field="r.job_order_date" /></td>
                <td t-att-rowspan="partcount" style="max-width:250px;"><span t-field="r.reason" /></td>
                <td  t-att-rowspan="partcount" style="max-width:250px;"><span t-field="r.corrective_action" /></td>
                <td t-att-rowspan="partcount"><span t-field="r.job_category_id" /></td>
                <td t-att-rowspan="partcount" style="width:10%"><span t-field="r.priority" /></td>
                <t t-foreach="r.spare_part_ids" t-as="d">
                   <t t-if="d_index  >0">
                            <![CDATA[<tr style="page-break-inside:avoid!important;">]]>
                   </t>
                   <td><span t-field="d.product_desc" /></td>
                   <td><span t-field="d.quantity" /></td>
                   <td><span t-esc="d.unit_price" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}' /></td>
                   <td><span t-esc="d.amount"  t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/></td>
                    <t t-if="d_index==0">
                        <td t-att-rowspan="partcount" style="vertical-align:top;"> <span t-esc="r.total_amount" t-esc-options='{"widget": "monetary", "display_currency": "res_company.currency_id"}'/></td>
                    </t>
                </t>
                <t t-if="partcount == 0">
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </t>
          </tr>
     </tbody>

</template>

<template id="report_machine_summary_main_template">
    <style type="text/css">
         .col-xs-2  text-left,col-xs-4  text-left{
            border: 1px solid;
        }
    </style>
     <t t-call="report.html_container">
          <t t-foreach="docs" t-as="o">
             <t t-call="cmms.cmms_internal_layout">
                <div class="page" style="padding-top:20px;">
                    <h3 class="text-center" style="color:red;">Machine History Card</h3>
                     <div class="row" style="outline: 1px solid;">
                         <div class="col-xs-2 text-left">Name:</div>
                         <div class="col-xs-2 text-left" style="border-right:1px solid;"><span t-field="o.name"/></div>
                         <div class="col-xs-2 text-left">Supplier:</div>
                         <div class="col-xs-2 text-left" style="border-right:1px solid;"><span t-field="o.supplier_id" /></div>
                         <div class="col-xs-2  text-left">Type:</div>
                         <div class="col-xs-2  text-left"><span t-field="o.type_id"/></div>
                     </div>
                     <div class="row" style="outline: 1px solid;">
                         <div class="col-xs-2  text-left">Machine No.:</div>
                         <div class="col-xs-2  text-left" style="border-right:1px solid;"><span t-field="o.code"/></div>
                         <div class="col-xs-2  text-left">Mfg Year:</div>
                         <div class="col-xs-2  text-left" style="border-right:1px solid;"><span t-field="o.mfg_year" /></div>
                         <div class="col-xs-2  text-left">Category:</div>
                         <div class="col-xs-2  text-left"><span t-field="o.category_id" /></div>
                     </div>
                     <div class="row" style="outline: 1px solid;">
                           <div class="col-xs-2  text-left">Model.:</div>
                           <div class="col-xs-2  text-left" style="border-right:1px solid;"><span t-field="o.model"/></div>
                           <div class="col-xs-2  text-left">Serial No.:</div>
                           <div class="col-xs-2  text-left" style="border-right:1px solid;"><span t-field="o.serial_no" /></div>
                           <div class="col-xs-2  text-left">Group:</div>
                           <div class="col-xs-2  text-left"><span t-field="o.group_id" /></div>

                     </div>
                     <div class="row" style="outline: 1px solid;min-height:15px;">
                           <div class="col-xs-2  text-left">Company:</div>
                           <div class="col-xs-4  text-left"><span t-field="o.company_id"/></div>
                           <div class="col-xs-2  text-left">Location:</div>
                           <div class="col-xs-4  text-left"><span t-field="o.location_id" /></div>
                     </div>

                <div class="row"  style="margin-top:15px;"/>
                <div class="row">
                    <table class="table table-bordered">
                        <thead>
                            <tr><th colspan="11" style="text-align:right;margin-right:50px;">PARTS USED</th></tr>
                            <tr>
                                <th> Code</th>
                                <th> Date </th>
                                <th> Cause/reason </th>
                                <th> Work Done </th>
                                <th> Category</th>
                                <th> Type </th>
                                <th> Description</th>
                                <th> Quantity </th>
                                <th> Unit Price </th>
                                <th> Amount </th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                           <t t-foreach="o.job_order_ids" t-as="r">
                               <t t-set="partcount" t-value="len(r.spare_part_ids)" />
                               <t t-if="r.job_order_type == 'breakdown' or 'preventive'">
                                   <t t-call="cmms.report_machine_summary_template"/>
                               </t>
                           </t>
                        </tbody>
                    </table>
                </div>
             </div>
         </t>
      </t>
     </t>
</template>

 <template id="report_machine_breakdown_summary_main_template">
    <style type="text/css">
         .col-xs-2  text-left,col-xs-4  text-left{
            border: 1px solid;
        }
    </style>
     <t t-call="report.html_container">
          <t t-foreach="docs" t-as="o">
             <t t-call="cmms.cmms_internal_layout">
                <div class="page" style="padding-top:20px;">
                    <h3 class="text-center" style="color:red;">Machine History Card</h3>
                     <div class="row" style="outline: 1px solid;">
                         <div class="col-xs-2 text-left">Name:</div>
                         <div class="col-xs-2 text-left" style="border-right:1px solid;"><span t-field="o.name"/></div>
                         <div class="col-xs-2 text-left">Supplier:</div>
                         <div class="col-xs-2 text-left" style="border-right:1px solid;"><span t-field="o.supplier_id" /></div>
                         <div class="col-xs-2  text-left">Type:</div>
                         <div class="col-xs-2  text-left"><span t-field="o.type_id"/></div>
                     </div>
                     <div class="row" style="outline: 1px solid;">
                         <div class="col-xs-2  text-left">Machine No.:</div>
                         <div class="col-xs-2  text-left" style="border-right:1px solid;"><span t-field="o.code"/></div>
                         <div class="col-xs-2  text-left">Mfg Year:</div>
                         <div class="col-xs-2  text-left" style="border-right:1px solid;"><span t-field="o.mfg_year" /></div>
                         <div class="col-xs-2  text-left">Category:</div>
                         <div class="col-xs-2  text-left"><span t-field="o.category_id" /></div>
                     </div>
                     <div class="row" style="outline: 1px solid;">
                           <div class="col-xs-2  text-left">Model.:</div>
                           <div class="col-xs-2  text-left" style="border-right:1px solid;"><span t-field="o.model"/></div>
                           <div class="col-xs-2  text-left">Serial No.:</div>
                           <div class="col-xs-2  text-left" style="border-right:1px solid;"><span t-field="o.serial_no" /></div>
                           <div class="col-xs-2  text-left">Group:</div>
                           <div class="col-xs-2  text-left"><span t-field="o.group_id" /></div>

                     </div>
                     <div class="row" style="outline: 1px solid;min-height:15px;">
                           <div class="col-xs-2  text-left">Company:</div>
                           <div class="col-xs-4  text-left"><span t-field="o.company_id"/></div>
                           <div class="col-xs-2  text-left">Location:</div>
                           <div class="col-xs-4  text-left"><span t-field="o.location_id" /></div>
                     </div>

                <div class="row"  style="margin-top:15px;"/>
                <div class="row">
                    <table class="table table-bordered">
                        <thead>
                            <tr><th colspan="11" style="text-align:right;margin-right:50px;">PARTS USED</th></tr>
                            <tr>
                                <th> Code</th>
                                <th> Date </th>
                                <th> Cause/reason </th>
                                <th> Work Done </th>
                                <th> Category</th>
                                <th> Type </th>
                                <th> Description</th>
                                <th> Quantity </th>
                                <th> Unit Price </th>
                                <th> Amount </th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                           <t t-foreach="o.job_order_ids" t-as="r">
                               <t t-set="partcount" t-value="len(r.spare_part_ids)" />
                               <t t-if="r.job_order_type == 'breakdown'">
                                   <t t-call="cmms.report_machine_summary_template"/>
                               </t>
                           </t>
                        </tbody>
                    </table>
                </div>
             </div>
         </t>
      </t>
     </t>
</template>
</data>
</odoo>
